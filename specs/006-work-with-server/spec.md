# 기능 명세서: 서버 본격 운용 및 아티클 입력 기능

**브랜치**: `006-work-with-server` | **날짜**: 2026-01-11 | **상태**: 초안

## 사용자 스토리

### 사용자 스토리 1 - 아티클 등록 (우선순위: P1)

개발자로서, 나는 읽은 기사나 블로그 포스트를 서버에 등록하여 나중에 RAG 시스템을 통해 검색하고 활용할 수 있기를 원한다.

**수용 기준**:
- 아티클의 제목, URL, 본문 내용, 태그를 입력할 수 있다.
- 입력된 아티클은 벡터 DB에 청크로 분할되어 저장된다.
- 저장된 아티클은 `/query` 엔드포인트를 통해 검색할 수 있다.

### 사용자 스토리 2 - 아티클 목록 조회 (우선순위: P2)

개발자로서, 나는 등록한 아티클 목록을 조회하여 어떤 정보들이 저장되어 있는지 확인할 수 있기를 원한다.

**수용 기준**:
- 등록된 아티클의 제목, URL, 등록일을 목록으로 조회할 수 있다.
- 페이지네이션을 지원한다.

### 사용자 스토리 3 - 서버 상시 구동 설정 (우선순위: P1)

개발자로서, 나는 서버가 재시작 후에도 자동으로 실행되도록 설정하여 PC 재부팅 후 수동으로 서버를 시작할 필요가 없기를 원한다.

**수용 기준**:
- PM2 또는 유사한 프로세스 매니저를 통해 서버가 관리된다.
- `pnpm start:prod` 명령어로 프로덕션 모드로 서버를 시작할 수 있다.
- 서버 로그가 파일로 저장된다.

### 사용자 스토리 4 - 아티클 피드백 및 품질 개선 (우선순위: P2)

개발자로서, 나는 아티클에 대한 피드백(좋음/나쁨)을 제공하여 좋은 평가를 받은 아티클이 RAG 검색 결과에서 더 높은 우선순위를 갖도록 하고 싶다.

**수용 기준**:
- 아티클에 대해 긍정적/부정적 피드백을 제출할 수 있다.
- 피드백에 따라 아티클의 평점(rating)이 업데이트된다.
- 높은 평점의 아티클 청크는 RAG 검색 시 더 높은 가중치를 받는다.
- 아티클별 피드백 통계를 조회할 수 있다.

## 기능적 요구사항

- **FR-001**: `/articles` 엔드포인트를 통해 아티클 등록 (POST), 목록 조회 (GET) 기능을 제공해야 한다.
- **FR-002**: 아티클 등록 시 `title`, `url`, `content` 필드는 필수이며, `tags`는 선택적이다.
- **FR-003**: 아티클 메타데이터(제목, URL, 등록일 등)는 별도의 저장소(JSON 파일 또는 SQLite)에 저장되어 목록 조회를 지원해야 한다.
- **FR-004**: 서버 시작 시 환경변수 유효성 검사를 수행해야 한다 (GEMINI_API_KEY 등).
- **FR-005**: `/articles/:id/feedback` 엔드포인트를 통해 아티클에 대한 피드백을 제출할 수 있어야 한다.
- **FR-006**: 피드백 제출 시 아티클의 `rating`, `positiveCount`, `negativeCount`를 업데이트해야 한다.
- **FR-007**: 피드백 제출 시 해당 아티클과 연결된 모든 벡터 청크의 `retrieval_score_modifier`를 조정해야 한다.
- **FR-008**: 긍정적 피드백은 `retrieval_score_modifier`를 증가시키고, 부정적 피드백은 감소시킨다.

## 비기능적 요구사항

- **NFR-001**: 서버는 PM2를 통해 백그라운드로 실행되어야 한다.
- **NFR-002**: 로그는 `logs/` 디렉토리에 날짜별로 저장되어야 한다.
- **NFR-003**: 아티클 등록 API 응답 시간은 2초 이내여야 한다.
- **NFR-004**: 피드백 기반 점수 조정은 즉시 반영되어야 한다 (다음 검색부터 적용).

## 제약 조건

- 기존 `/knowledge` API와의 호환성을 유지해야 한다.
- Windows 환경에서의 PM2 설정을 고려해야 한다.
- 기존 `/feedback` API와 병행하여 동작하되, 아티클 전용 피드백 경로를 추가한다.

## 성공 지표

- 서버 가동 시간 99% 이상 (로컬 환경 기준)
- 아티클 10개 이상 등록 후 관련 질의에 대해 정확한 응답 반환
- 피드백을 받은 아티클의 검색 순위가 피드백에 따라 조정됨
