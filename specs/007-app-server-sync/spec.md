# 기능 명세서: 앱-서버 아티클 동기화

**브랜치**: `007-app-server-sync` | **날짜**: 2026-01-11 | **상태**: 초안

## 사용자 스토리

### 사용자 스토리 1 - 아티클 읽음 시 서버 전송 (우선순위: P1)

개발자로서, 나는 Tauri 앱에서 아티클을 읽을 때 해당 아티클 정보가 자동으로 AI Brain Server로 전송되어 RAG 시스템에 축적되기를 원한다.

**수용 기준**:
- 아티클 상세 보기 시 서버에 아티클 정보가 전송된다.
- 서버 URL은 환경변수(`BRAIN_SERVER_URL`)로 구성 가능하다.
- 전송 실패 시에도 앱 사용에 영향이 없다 (비동기 처리).
- 동일 아티클의 중복 전송을 방지한다 (SQLite로 전송 상태 추적).
- 아티클의 `title`, `url`, `summary`(content로 사용), `tags`를 전송한다.

### 사용자 스토리 2 - 피드백 서버 전송 (우선순위: P2)

개발자로서, 나는 앱에서 아티클에 피드백을 남기면 해당 피드백이 서버에도 전송되어 RAG 검색 품질이 개선되기를 원한다.

**수용 기준**:
- 앱에서 피드백(좋음/나쁨)을 제출하면 서버에도 동시에 전송된다.
- 서버 전송 실패 시에도 로컬 피드백은 저장된다.
- 서버에 아티클이 전송된 경우에만 피드백을 전송한다.

### 사용자 스토리 3 - 서버 연결 설정 (우선순위: P1)

개발자로서, 나는 앱에서 서버 연결 상태를 확인할 수 있기를 원한다.

**수용 기준**:
- 서버 URL을 환경변수(`BRAIN_SERVER_URL`)로 구성할 수 있다.
- Tauri 명령어로 서버 헬스체크를 수행할 수 있다.
- 연결 실패 시 적절한 에러 처리가 된다.

## 기능적 요구사항

- **FR-001**: Tauri 앱에서 `reqwest`를 사용하여 서버 API(`/articles`)를 호출해야 한다.
- **FR-002**: 아티클 전송 시 `title`, `url`, `content`(summary), `tags`를 포함해야 한다.
- **FR-003**: 피드백 전송 시 서버의 `/articles/:id/feedback` API를 호출해야 한다.
- **FR-004**: 서버 URL은 `BRAIN_SERVER_URL` 환경변수로 설정 가능해야 한다 (기본값: `http://localhost:3000`).
- **FR-005**: 이미 전송된 아티클은 SQLite DB의 `synced_at` 필드로 추적하여 중복 전송을 방지해야 한다.
- **FR-006**: 전송된 아티클의 서버 ID(`server_article_id`)를 저장하여 피드백 전송 시 사용해야 한다.

## 비기능적 요구사항

- **NFR-001**: 서버 API 호출은 Tauri의 async_runtime에서 비동기로 처리되어 UI 블로킹이 없어야 한다.
- **NFR-002**: API 호출 실패 시 eprintln!으로 에러를 로깅하되 앱 기능에 영향이 없어야 한다.
- **NFR-003**: API 호출 타임아웃은 5초로 설정한다.

## 제약 조건

- 기존 Tauri 앱 기능에 영향을 주지 않아야 한다.
- 서버가 꺼져 있어도 앱은 정상 동작해야 한다.
- 기존 `reqwest::Client`를 재사용해야 한다 (RecommendationState에서 관리).

## 성공 지표

- 앱에서 아티클을 5개 이상 읽으면 서버에 해당 아티클들이 저장됨
- 서버의 `/query` API로 앱에서 읽은 아티클 내용을 검색할 수 있음
